# å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤åŸºç›¤ - ãƒ†ã‚¹ãƒˆæ–¹é‡ãƒ»è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«

**å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ **: å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ | **æƒ³å®šè¦æ¨¡**: 8,000å Ã— 100éƒ¨é–€ï¼ˆãƒ†ãƒŠãƒ³ãƒˆï¼‰ | **ä½œæˆæ—¥**: 2025-12-12

---

## ğŸ¯ ãƒ†ã‚¹ãƒˆæ–¹é‡æ¦‚è¦

### åŸºæœ¬æ–¹é‡

å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤åŸºç›¤ã®ãƒ†ã‚¹ãƒˆã¯ã€**ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œï¼ˆãƒ†ãƒŠãƒ³ãƒˆãƒªã‚¾ãƒ«ãƒï¼‰**ã¨**LLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**ã‚’ä¸­å¿ƒã«å®Ÿæ–½ã—ã€ã‚¤ãƒ³ãƒ•ãƒ©ã®ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒ«ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œã¯**AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã¨ãƒ„ãƒ¼ãƒ«**ã‚’æ´»ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

| é …ç›® | æ–¹é‡ |
|------|------|
| **ãƒ†ã‚¹ãƒˆé‡ç‚¹é ˜åŸŸ** | 1. ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆèªè¨¼ãƒ»èªå¯ï¼ˆãƒ†ãƒŠãƒ³ãƒˆãƒªã‚¾ãƒ«ãƒï¼‰<br>2. LLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ï¼ˆçµ±åˆAPIã€ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¬ãƒãƒŠãƒ³ã‚¹ï¼‰<br>3. ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆTextractã€ãƒãƒ£ãƒ³ã‚­ãƒ³ã‚°ã€Auroraæ ¼ç´ï¼‰ |
| **AWSæ¨™æº–æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ** | AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆCognitoã€Bedrockã€Auroraç­‰ï¼‰ã®åŸºæœ¬æ©Ÿèƒ½ã¯**AWSãŒä¿è¨¼**ã™ã‚‹ãŸã‚ã€çµ±åˆãƒ†ã‚¹ãƒˆã§ã®å‹•ä½œç¢ºèªã®ã¿å®Ÿæ–½ |
| **ã‚¤ãƒ³ãƒ•ãƒ©ãƒ†ã‚¹ãƒˆ** | Auto Scalingã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°ã€éšœå®³æ™‚ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ç­‰ã¯**AWSæ¨™æº–ãƒ„ãƒ¼ãƒ«**ï¼ˆCloudWatch Alarmsã€AWS Configã€AWS Resilience Hubï¼‰ã§æ¤œè¨¼ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ** | **AWS Security Hub**ã€**AWS Inspector**ã€**AWS Config Rules**ã‚’æ´»ç”¨ã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚’è‡ªå‹•æ¤œè¨¼ |
| **ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–** | CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆGitHub Actions / AWS CodePipelineï¼‰ã«çµ±åˆã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’å®Ÿç¾ |

### ãƒ†ã‚¹ãƒˆè¦³ç‚¹ã¨ãƒ†ã‚¹ãƒˆãƒ¬ãƒ™ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰ï¼ˆæ¨å¥¨ãƒãƒ©ãƒ³ã‚¹ï¼‰                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚                       E2Eãƒ†ã‚¹ãƒˆ                                â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                     â”‚  10ä»¶ç¨‹åº¦   â”‚ â† CloudWatch Synthetics   â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                â”‚
â”‚                   çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆAPIï¼‰                            â”‚
â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                â”‚     50ä»¶ç¨‹åº¦         â”‚ â† pytest / Jest       â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                â”‚
â”‚              å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆLambdaé–¢æ•°ï¼‰                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚          â”‚         200ä»¶ç¨‹åº¦               â”‚ â† pytest / Jest  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| ãƒ†ã‚¹ãƒˆãƒ¬ãƒ™ãƒ« | ç›®çš„ | å¯¾è±¡ | è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ« | å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚° |
|------------|------|------|------------|--------------|
| **å˜ä½“ãƒ†ã‚¹ãƒˆ** | Lambdaé–¢æ•°ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ¤œè¨¼ | Lambdaé–¢æ•°ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° | pytest (Python)<br>Jest (TypeScript) | ã‚³ãƒŸãƒƒãƒˆæ™‚ï¼ˆCIï¼‰ |
| **çµ±åˆãƒ†ã‚¹ãƒˆ** | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ»AWSã‚µãƒ¼ãƒ“ã‚¹é€£æºã®æ¤œè¨¼ | API Gateway + Lambdaã€Cognitoçµ±åˆã€Auroraçµ±åˆ | pytest + moto<br>Jest + AWS SDK Mock | ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ï¼ˆCIï¼‰ |
| **E2Eãƒ†ã‚¹ãƒˆ** | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚·ãƒŠãƒªã‚ªã®æ¤œè¨¼ | èªè¨¼ãƒ•ãƒ­ãƒ¼ã€ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã€ç®¡ç†ç”»é¢æ“ä½œ | CloudWatch Synthetics<br>Playwright | ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼ˆCDï¼‰ |
| **è² è·ãƒ†ã‚¹ãƒˆ** | ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æ¤œè¨¼ | API Gatewayã€Lambdaã€Aurora | Locust / Artillery | ãƒªãƒªãƒ¼ã‚¹å‰ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ** | è„†å¼±æ€§ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã®æ¤œè¨¼ | å…¨ãƒªã‚½ãƒ¼ã‚¹ | AWS Security Hub<br>AWS Inspector<br>AWS Config | ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼ˆè‡ªå‹•ï¼‰ |
| **ã‚¤ãƒ³ãƒ•ãƒ©ãƒ†ã‚¹ãƒˆ** | Auto Scalingã€éšœå®³å¾©æ—§ã®æ¤œè¨¼ | ALBã€ECSã€Auroraã€Lambda | AWS Resilience Hub<br>CloudWatch Alarms | é€±æ¬¡ï¼ˆè‡ªå‹•ï¼‰ |

---

## ğŸ” ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆè¦³ç‚¹

| ãƒ†ã‚¹ãƒˆè¦³ç‚¹ | ç›®çš„ | å„ªå…ˆåº¦ |
|----------|------|--------|
| **ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢** | ç•°ãªã‚‹éƒ¨é–€ã®ãƒ‡ãƒ¼ã‚¿ãŒæ··åœ¨ã—ãªã„ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **èªè¨¼ãƒ»èªå¯** | æ­£ã—ã„ãƒ†ãƒŠãƒ³ãƒˆIDãŒJWTã«å«ã¾ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡** | ãƒ†ãƒŠãƒ³ãƒˆå¤–ã®ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ã‚°ãƒ«ãƒ¼ãƒ—è‡ªå‹•å‰²ã‚Šå½“ã¦** | åˆå›ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«æ­£ã—ã„Cognitoã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |
| **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ** | 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°éƒ¨é–€ã«æ‰€å±ã§ãã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹

#### 1. ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: å–¶æ¥­éƒ¨ï¼ˆSG-Salesï¼‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ã‚±éƒ¨ï¼ˆSG-Marketingï¼‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã‚’ç¢ºèª

```python
# pytest: test_tenant_isolation.py
import pytest
from moto import mock_s3, mock_cognito_idp
from app.lambda_handlers.chat_gateway import handler

@pytest.fixture
def mock_jwt_sales():
    """å–¶æ¥­éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ¢ãƒƒã‚¯"""
    return {
        'cognito:groups': ['User-SG-Sales'],
        'email': 'user@sales.example.com',
    }

@pytest.fixture
def mock_jwt_marketing():
    """ãƒãƒ¼ã‚±éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ¢ãƒƒã‚¯"""
    return {
        'cognito:groups': ['User-SG-Marketing'],
        'email': 'user@marketing.example.com',
    }

def test_tenant_isolation_document_access(mock_jwt_sales):
    """å–¶æ¥­éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ã‚±éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã‚’ç¢ºèª"""
    # å–¶æ¥­éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒãƒ¼ã‚±éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è©¦è¡Œ
    event = {
        'requestContext': {
            'authorizer': {'claims': mock_jwt_sales}
        },
        'body': json.dumps({
            'documentKey': 'SG-Marketing/confidential-report.pdf'
        })
    }

    response = handler(event, {})

    # 403 Forbidden ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    assert response['statusCode'] == 403
    assert 'ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“' in json.loads(response['body'])['error']

def test_tenant_isolation_knowledge_base_search(mock_jwt_sales):
    """å–¶æ¥­éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ã‚±éƒ¨ã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ã§ããªã„ã“ã¨ã‚’ç¢ºèª"""
    with mock_bedrock():
        # å–¶æ¥­éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§æ¤œç´¢å®Ÿè¡Œ
        event = {
            'requestContext': {
                'authorizer': {'claims': mock_jwt_sales}
            },
            'body': json.dumps({
                'message': 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥ã«ã¤ã„ã¦æ•™ãˆã¦',
                'model': 'claude-3-5-sonnet'
            })
        }

        response = handler(event, {})

        # æ¤œç´¢çµæœã«ãƒãƒ¼ã‚±éƒ¨ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª
        body = json.loads(response['body'])
        sources = body.get('sources', [])

        for source in sources:
            assert not source['s3Key'].startswith('SG-Marketing/')
            assert source['s3Key'].startswith('SG-Sales/')
```

#### 2. èªè¨¼ãƒ»èªå¯ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: SAMLèªè¨¼å¾Œã€æ­£ã—ã„Cognitoã‚°ãƒ«ãƒ¼ãƒ—ã«è‡ªå‹•å‰²ã‚Šå½“ã¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

```python
# pytest: test_authentication.py
import boto3
from moto import mock_cognito_idp, mock_s3

@mock_cognito_idp
@mock_s3
def test_post_authentication_trigger_admin_assignment():
    """åˆå›ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ç®¡ç†è€…ã‚°ãƒ«ãƒ¼ãƒ—ã«è‡ªå‹•è¿½åŠ ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª"""
    # Cognito User Pool ãƒ¢ãƒƒã‚¯ä½œæˆ
    cognito = boto3.client('cognito-idp', region_name='ap-northeast-1')
    user_pool = cognito.create_user_pool(PoolName='TestPool')
    user_pool_id = user_pool['UserPool']['Id']

    # Admin-SG-Sales ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
    cognito.create_group(
        GroupName='Admin-SG-Sales',
        UserPoolId=user_pool_id,
    )

    # S3ã«ä¿ç•™ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®
    s3 = boto3.client('s3', region_name='ap-northeast-1')
    s3.create_bucket(
        Bucket='pending-assignments',
        CreateBucketConfiguration={'LocationConstraint': 'ap-northeast-1'}
    )
    s3.put_object(
        Bucket='pending-assignments',
        Key='tanaka@isuzu.co.jp.json',
        Body=json.dumps({
            'email': 'tanaka@isuzu.co.jp',
            'groups': ['Admin-SG-Sales']
        })
    )

    # Lambda Triggerå®Ÿè¡Œ
    from app.lambda_handlers.post_authentication import handler

    event = {
        'request': {
            'userAttributes': {
                'email': 'tanaka@isuzu.co.jp'
            }
        },
        'userPoolId': user_pool_id,
        'userName': 'tanaka@isuzu.co.jp',
    }

    response = handler(event, {})

    # ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ã‚’ç¢ºèª
    groups = cognito.admin_list_groups_for_user(
        Username='tanaka@isuzu.co.jp',
        UserPoolId=user_pool_id
    )

    assert len(groups['Groups']) == 1
    assert groups['Groups'][0]['GroupName'] == 'Admin-SG-Sales'

    # S3ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    with pytest.raises(s3.exceptions.NoSuchKey):
        s3.get_object(
            Bucket='pending-assignments',
            Key='tanaka@isuzu.co.jp.json'
        )
```

#### 3. ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…å°‚ç”¨APIã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã‚’ç¢ºèª

```python
# pytest: test_access_control.py
def test_user_cannot_access_admin_api(mock_jwt_user):
    """ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…å°‚ç”¨APIã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã‚’ç¢ºèª"""
    from app.lambda_handlers.create_tenant import handler

    event = {
        'requestContext': {
            'authorizer': {'claims': mock_jwt_user}  # User-SG-Sales
        },
        'body': json.dumps({
            'tenantName': 'SG-NewDepartment'
        })
    }

    response = handler(event, {})

    # 403 Forbidden ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    assert response['statusCode'] == 403
    assert 'ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™' in json.loads(response['body'])['error']
```

---

## ğŸŒ LLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆè¦³ç‚¹

| ãƒ†ã‚¹ãƒˆè¦³ç‚¹ | ç›®çš„ | å„ªå…ˆåº¦ |
|----------|------|--------|
| **çµ±åˆAPIå‹•ä½œ** | Bedrock APIå‘¼ã³å‡ºã—ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°** | æ¤œç´¢çµæœãŒæ­£ã—ãéƒ¨é–€åˆ¥ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ã‚¬ãƒãƒŠãƒ³ã‚¹ãƒ­ã‚°** | ã™ã¹ã¦ã®APIå‘¼ã³å‡ºã—ãŒãƒ†ãƒŠãƒ³ãƒˆIDã¨å…±ã«ãƒ­ã‚°è¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°** | UIã§æŒ‡å®šã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ãŒæ­£ã—ãå‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |
| **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** | Bedrock API ã‚¨ãƒ©ãƒ¼æ™‚ã«é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |
| **ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡è¨˜éŒ²** | ã‚³ã‚¹ãƒˆé…è³¦ç”¨ã®ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ãŒæ­£ç¢ºã«è¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¢ Medium |

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹

#### 1. ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: Knowledge Base æ¤œç´¢æ™‚ã«éƒ¨é–€åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãŒæ­£ã—ãé©ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

```typescript
// Jest: test_knowledge_base_filtering.test.ts
import { handler } from '../src/lambda/chat_gateway';
import { BedrockAgentRuntimeClient, RetrieveCommand } from '@aws-sdk/client-bedrock-agent-runtime';

jest.mock('@aws-sdk/client-bedrock-agent-runtime');

describe('Knowledge Base Filtering', () => {
  it('should apply tenant filter to knowledge base search', async () => {
    // ãƒ¢ãƒƒã‚¯ã®æº–å‚™
    const mockSend = jest.fn().mockResolvedValue({
      retrievalResults: [
        {
          content: { text: 'Test content' },
          metadata: { department: 'SG-Sales' }
        }
      ]
    });

    (BedrockAgentRuntimeClient as jest.Mock).mockImplementation(() => ({
      send: mockSend
    }));

    // ã‚¤ãƒ™ãƒ³ãƒˆæº–å‚™
    const event = {
      requestContext: {
        authorizer: {
          claims: {
            'cognito:groups': ['User-SG-Sales'],
            'email': 'user@sales.example.com'
          }
        }
      },
      body: JSON.stringify({
        message: 'å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆã«ã¤ã„ã¦æ•™ãˆã¦',
        model: 'claude-3-5-sonnet'
      })
    };

    // Lambdaå®Ÿè¡Œ
    await handler(event, {});

    // BedrockAgentRuntimeClient.send ãŒæ­£ã—ã„ãƒ•ã‚£ãƒ«ã‚¿ã§å‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
    expect(mockSend).toHaveBeenCalledWith(
      expect.objectContaining({
        input: expect.objectContaining({
          retrievalConfiguration: expect.objectContaining({
            vectorSearchConfiguration: expect.objectContaining({
              filter: {
                equals: {
                  key: 'department',
                  value: 'SG-Sales'
                }
              }
            })
          })
        })
      })
    );
  });
});
```

#### 2. ã‚¬ãƒãƒŠãƒ³ã‚¹ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: ã™ã¹ã¦ã®APIå‘¼ã³å‡ºã—ãŒãƒ†ãƒŠãƒ³ãƒˆIDã¨å…±ã«CloudWatch Logsã«è¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

```typescript
// Jest: test_governance_logging.test.ts
import { handler } from '../src/lambda/chat_gateway';

describe('Governance Logging', () => {
  let consoleLogSpy: jest.SpyInstance;

  beforeEach(() => {
    consoleLogSpy = jest.spyOn(console, 'log').mockImplementation();
  });

  afterEach(() => {
    consoleLogSpy.mockRestore();
  });

  it('should log all API calls with tenant ID', async () => {
    const event = {
      requestContext: {
        authorizer: {
          claims: {
            'cognito:groups': ['User-SG-Sales'],
            'email': 'user@sales.example.com'
          }
        }
      },
      body: JSON.stringify({
        message: 'ãƒ†ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
        model: 'claude-3-5-sonnet'
      })
    };

    await handler(event, {});

    // ã‚¬ãƒãƒŠãƒ³ã‚¹ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
    const logCalls = consoleLogSpy.mock.calls;
    const governanceLog = logCalls.find(call => {
      const logEntry = JSON.parse(call[0]);
      return logEntry.action === 'chat' && logEntry.tenantId === 'SG-Sales';
    });

    expect(governanceLog).toBeDefined();

    const logEntry = JSON.parse(governanceLog[0]);
    expect(logEntry).toMatchObject({
      tenantId: 'SG-Sales',
      userId: 'user@sales.example.com',
      action: 'chat',
      model: 'claude-3-5-sonnet'
    });
  });

  it('should log token usage for cost allocation', async () => {
    // ... (åŒæ§˜ã®å®Ÿè£…ã§ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ãƒ­ã‚°ã‚’ç¢ºèª)
  });
});
```

#### 3. ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**: UIã§æŒ‡å®šã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ãŒæ­£ã—ãBedrock APIã«æ¸¡ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

```typescript
// Jest: test_model_routing.test.ts
describe('Model Routing', () => {
  it('should route to correct Bedrock model based on UI selection', async () => {
    const testCases = [
      { uiModel: 'claude-3-5-sonnet', expectedModelId: 'anthropic.claude-3-5-sonnet-20240620-v1:0' },
      { uiModel: 'claude-3-haiku', expectedModelId: 'anthropic.claude-3-haiku-20240307-v1:0' },
    ];

    for (const testCase of testCases) {
      const mockSend = jest.fn().mockResolvedValue({ body: '{}' });

      (BedrockRuntimeClient as jest.Mock).mockImplementation(() => ({
        send: mockSend
      }));

      const event = {
        requestContext: {
          authorizer: {
            claims: {
              'cognito:groups': ['User-SG-Sales'],
              'email': 'user@sales.example.com'
            }
          }
        },
        body: JSON.stringify({
          message: 'ãƒ†ã‚¹ãƒˆ',
          model: testCase.uiModel
        })
      };

      await handler(event, {});

      expect(mockSend).toHaveBeenCalledWith(
        expect.objectContaining({
          input: expect.objectContaining({
            modelId: testCase.expectedModelId
          })
        })
      );
    }
  });
});
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆè¦³ç‚¹

| ãƒ†ã‚¹ãƒˆè¦³ç‚¹ | ç›®çš„ | å„ªå…ˆåº¦ |
|----------|------|--------|
| **Textractçµ±åˆ** | è¡¨æ§‹é€ ãŒæ­£ã—ãMarkdownå½¢å¼ã«å¤‰æ›ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ£ãƒ³ã‚­ãƒ³ã‚°** | è¦‹å‡ºã—ãƒ»æ®µè½å˜ä½ã§é©åˆ‡ã«åˆ†å‰²ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸ”´ Critical |
| **Embeddingsç”Ÿæˆ** | æ­£ã—ã„æ¬¡å…ƒæ•°ã®ãƒ™ã‚¯ãƒˆãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |
| **Auroraæ ¼ç´** | è¦ªå­é–¢ä¿‚ãŒæ­£ã—ãä¿æŒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª | ğŸŸ¡ High |

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹

```python
# pytest: test_document_processing.py
def test_table_extraction_with_textract():
    """Textractã§è¡¨ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãMarkdownå½¢å¼ã«å¤‰æ›ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª"""
    from app.lambda_handlers.document_processing import handler, convertTableToMarkdown

    # Textractã®ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆè¡¨ãƒ‡ãƒ¼ã‚¿ï¼‰
    mock_textract_response = {
        'Blocks': [
            {
                'BlockType': 'TABLE',
                'Id': 'table-1',
                'Relationships': [
                    {'Type': 'CHILD', 'Ids': ['cell-1-1', 'cell-1-2', 'cell-2-1', 'cell-2-2']}
                ]
            },
            {'BlockType': 'CELL', 'Id': 'cell-1-1', 'RowIndex': 1, 'ColumnIndex': 1, 'Text': 'è£½å“å'},
            {'BlockType': 'CELL', 'Id': 'cell-1-2', 'RowIndex': 1, 'ColumnIndex': 2, 'Text': 'ä¾¡æ ¼'},
            {'BlockType': 'CELL', 'Id': 'cell-2-1', 'RowIndex': 2, 'ColumnIndex': 1, 'Text': 'å•†å“A'},
            {'BlockType': 'CELL', 'Id': 'cell-2-2', 'RowIndex': 2, 'ColumnIndex': 2, 'Text': '1,000å††'},
        ]
    }

    # Markdownå¤‰æ›å®Ÿè¡Œ
    tables = extractTables(mock_textract_response['Blocks'])
    markdown = convertTableToMarkdown(tables[0])

    # æœŸå¾…ã•ã‚Œã‚‹Markdownå½¢å¼
    expected_markdown = """| è£½å“å | ä¾¡æ ¼ |
|---|---|
| å•†å“A | 1,000å†† |"""

    assert markdown.strip() == expected_markdown.strip()

def test_semantic_chunking():
    """ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯å¢ƒç•Œèªè­˜ãƒãƒ£ãƒ³ã‚­ãƒ³ã‚°ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª"""
    from app.lambda_handlers.document_processing import smartChunking

    # ãƒ†ã‚¹ãƒˆç”¨ãƒ†ã‚­ã‚¹ãƒˆï¼ˆè¦‹å‡ºã—ãƒ»æ®µè½ã‚’å«ã‚€ï¼‰
    test_text = """# ç¬¬1ç«  æ¦‚è¦

æœ¬ç« ã§ã¯ã€å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®æ¦‚è¦ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## 1.1 ç›®çš„

å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã¯ã€ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œã®RAGåŸºç›¤ã§ã™ã€‚

# ç¬¬2ç«  ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

æœ¬ç« ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚"""

    # ãƒãƒ£ãƒ³ã‚­ãƒ³ã‚°å®Ÿè¡Œ
    chunks = smartChunking(test_text, {
        'maxTokens': 100,
        'overlapTokens': 20,
        'respectBoundaries': True
    })

    # è¦‹å‡ºã—ã§åˆ†å‰²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    assert len(chunks) >= 2
    assert 'ç¬¬1ç« ' in chunks[0]['text']
    assert 'ç¬¬2ç« ' in chunks[1]['text']

    # æ®µè½å¢ƒç•ŒãŒä¿æŒã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    for chunk in chunks:
        assert not chunk['text'].endswith('ã€‚\næœ¬')  # ä¸è‡ªç„¶ãªåˆ†å‰²ãŒãªã„ã“ã¨ã‚’ç¢ºèª
```

---

## ğŸ›¡ï¸ ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆï¼ˆAWSãƒ„ãƒ¼ãƒ«æ´»ç”¨ï¼‰

### AWSæ¨™æº–ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

| ãƒ†ã‚¹ãƒˆè¦³ç‚¹ | ä½¿ç”¨ãƒ„ãƒ¼ãƒ« | å®Ÿè¡Œé »åº¦ | è‡ªå‹•åŒ– |
|----------|----------|---------|--------|
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹** | AWS Security Hub<br>AWS Config Rules | ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼ˆè‡ªå‹•ï¼‰ | âœ… è‡ªå‹• |
| **è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³** | AWS Inspector (ECR/Lambda) | ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼ˆè‡ªå‹•ï¼‰ | âœ… è‡ªå‹• |
| **ã‚¤ãƒ³ãƒ•ãƒ©è¨­å®šæ¤œè¨¼** | AWS Config | ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼ˆè‡ªå‹•ï¼‰ | âœ… è‡ªå‹• |
| **Auto Scalingæ¤œè¨¼** | CloudWatch Alarms + Load Testing | ãƒªãƒªãƒ¼ã‚¹å‰ | ğŸ”¶ åŠè‡ªå‹• |
| **éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆ** | AWS Resilience Hub | æœˆæ¬¡ | ğŸ”¶ åŠè‡ªå‹• |
| **åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°** | AWS X-Ray | å¸¸æ™‚ï¼ˆæœ¬ç•ªç›£è¦–ï¼‰ | âœ… è‡ªå‹• |

### 1. AWS Security Hub - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

**è‡ªå‹•æ¤œè¨¼é …ç›®**:

```yaml
# AWS Config Rules (CDKå®šç¾©ä¾‹)
security_hub_standards:
  - AWS Foundational Security Best Practices
  - CIS AWS Foundations Benchmark

config_rules:
  - s3-bucket-public-read-prohibited
  - s3-bucket-public-write-prohibited
  - encrypted-volumes
  - rds-encryption-enabled
  - lambda-function-public-access-prohibited
  - api-gw-execution-logging-enabled
  - cognito-user-pool-mfa-configuration-check
```

**CDKå®Ÿè£…ä¾‹**:

```typescript
// CDK: Security Hub + Config Rules
import * as config from 'aws-cdk-lib/aws-config';
import * as securityhub from 'aws-cdk-lib/aws-securityhub';

// Security Hubæœ‰åŠ¹åŒ–
new securityhub.CfnHub(this, 'SecurityHub', {
  enableDefaultStandards: true,
});

// Config Rulesè¨­å®š
new config.ManagedRule(this, 'S3BucketPublicReadProhibited', {
  identifier: config.ManagedRuleIdentifiers.S3_BUCKET_PUBLIC_READ_PROHIBITED,
});

new config.ManagedRule(this, 'EncryptedVolumes', {
  identifier: config.ManagedRuleIdentifiers.ENCRYPTED_VOLUMES,
});

new config.ManagedRule(this, 'RDSEncryptionEnabled', {
  identifier: config.ManagedRuleIdentifiers.RDS_STORAGE_ENCRYPTED,
});

new config.ManagedRule(this, 'LambdaPublicAccessProhibited', {
  identifier: config.ManagedRuleIdentifiers.LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED,
});
```

### 2. AWS Inspector - è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³

**è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³å¯¾è±¡**:

- ECRã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆWeb UIï¼‰
- Lambdaé–¢æ•°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆBastionã‚µãƒ¼ãƒãƒ¼ç­‰ï¼‰

**CDKå®Ÿè£…ä¾‹**:

```typescript
// CDK: Inspector v2 æœ‰åŠ¹åŒ–
import * as inspector2 from 'aws-cdk-lib/aws-inspector2';

new inspector2.CfnEnabler(this, 'Inspector2Enabler', {
  resourceTypes: ['ECR', 'LAMBDA', 'EC2'],
});

// ECRã‚¹ã‚­ãƒ£ãƒ³è¨­å®š
ecrRepository.addLifecycleRule({
  description: 'Scan on push',
  rulePriority: 1,
  tagStatus: ecr.TagStatus.ANY,
  maxImageAge: cdk.Duration.days(30),
});
```

### 3. AWS Resilience Hub - éšœå®³å¾©æ—§ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**:

1. **AZéšœå®³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: ç‰¹å®šã®AZãŒåˆ©ç”¨ä¸å¯ã«ãªã£ãŸå ´åˆã®è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ç¢ºèª
2. **Lambdaé–¢æ•°éšœå®³**: Lambdaé–¢æ•°ãŒã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ãŸå ´åˆã®ãƒªãƒˆãƒ©ã‚¤å‹•ä½œã‚’ç¢ºèª
3. **Auroraéšœå®³**: Auroraã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹éšœå®³æ™‚ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã‚’ç¢ºèª

**å®Ÿè£…ä¾‹** (AWS CLI):

```bash
# Resilience Hub ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç™»éŒ²
aws resiliencehub create-app \
  --name "GenU-LLM-Gateway" \
  --description "å…¨ç¤¾å…±é€šLLMã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤åŸºç›¤" \
  --assessment-schedule Disabled

# CloudFormation ã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
aws resiliencehub import-resources-to-draft-app-version \
  --app-arn arn:aws:resiliencehub:ap-northeast-1:123456789012:app/abcd1234 \
  --source-arns arn:aws:cloudformation:ap-northeast-1:123456789012:stack/GenerativeAiUseCasesStackdev2/*

# ãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹ãƒãƒªã‚·ãƒ¼è¨­å®šï¼ˆRTO/RPOï¼‰
aws resiliencehub put-draft-app-version-template \
  --app-arn arn:aws:resiliencehub:ap-northeast-1:123456789012:app/abcd1234 \
  --app-template-body '{
    "appComponents": [
      {
        "name": "LLMGateway",
        "type": "AWS::Lambda::Function",
        "resourceIdentifier": "ChatGateway",
        "resilience": {
          "rto": 600,
          "rpo": 3600
        }
      }
    ]
  }'

# ãƒ¬ã‚¸ãƒªã‚¨ãƒ³ã‚¹ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆå®Ÿè¡Œ
aws resiliencehub start-app-assessment \
  --app-arn arn:aws:resiliencehub:ap-northeast-1:123456789012:app/abcd1234
```

### 4. CloudWatch Synthetics - E2Eãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**:

- ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼ï¼ˆCognito Hosted UI â†’ SAMLèªè¨¼ â†’ JWTå–å¾—ï¼‰
- ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ â†’ ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡ï¼‰
- ç®¡ç†ç”»é¢æ“ä½œï¼ˆéƒ¨é–€ä½œæˆ â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹›å¾…ï¼‰

**å®Ÿè£…ä¾‹**:

```typescript
// CDK: CloudWatch Synthetics Canary
import * as synthetics from 'aws-cdk-lib/aws-synthetics';

const canary = new synthetics.Canary(this, 'ChatUICanary', {
  canaryName: 'genu-chat-ui-e2e',
  runtime: synthetics.Runtime.SYNTHETICS_NODEJS_PUPPETEER_4_0,
  test: synthetics.Test.custom({
    code: synthetics.Code.fromAsset('canary'),
    handler: 'index.handler',
  }),
  schedule: synthetics.Schedule.rate(cdk.Duration.minutes(15)),
  environmentVariables: {
    COGNITO_DOMAIN: cognitoUserPool.userPoolProviderUrl,
    APP_URL: 'https://llm-gateway.isuzu.co.jp',
  },
});

// Canary ã‚¹ã‚¯ãƒªãƒ—ãƒˆ (canary/index.js)
const synthetics = require('Synthetics');
const log = require('SyntheticsLogger');

const chatUITest = async function() {
  const page = await synthetics.getPage();

  // 1. ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
  await page.goto(process.env.APP_URL);

  // 2. Entra ID ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
  await page.click('button[data-testid="login-button"]');

  // 3. Cognito Hosted UI ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  await page.waitForSelector('input[name="username"]');

  // 4. ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³
  await page.type('input[name="username"]', process.env.TEST_USER_EMAIL);
  await page.type('input[name="password"]', process.env.TEST_USER_PASSWORD);
  await page.click('input[type="submit"]');

  // 5. ãƒãƒ£ãƒƒãƒˆç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  await page.waitForSelector('div[data-testid="chat-container"]', { timeout: 10000 });

  // 6. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
  await page.type('textarea[data-testid="message-input"]', 'ãƒ†ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸');
  await page.click('button[data-testid="send-button"]');

  // 7. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
  await page.waitForSelector('div[data-testid="assistant-message"]', { timeout: 30000 });

  log.info('Chat UI E2E test passed');
};

exports.handler = async () => {
  return await chatUITest();
};
```

### 5. è² è·ãƒ†ã‚¹ãƒˆï¼ˆLocustï¼‰

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**:

- åŒæ™‚æ¥ç¶šæ•°: 1,000ãƒ¦ãƒ¼ã‚¶ãƒ¼
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: ãƒãƒ£ãƒƒãƒˆAPIï¼ˆ`POST /api/chat`ï¼‰
- ç›®æ¨™: 95ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã§3ç§’ä»¥å†…ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹

**å®Ÿè£…ä¾‹**:

```python
# locustfile.py
from locust import HttpUser, task, between
import json

class ChatUser(HttpUser):
    wait_time = between(1, 3)

    def on_start(self):
        """ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—"""
        # Cognito Hosted UIçµŒç”±ã§ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        response = self.client.post('/auth/token', json={
            'username': 'testuser@isuzu.co.jp',
            'password': 'TestPassword123!'
        })
        self.token = response.json()['id_token']

    @task(10)
    def send_chat_message(self):
        """ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ï¼ˆæœ€ã‚‚é »ç¹ã«å®Ÿè¡Œï¼‰"""
        headers = {
            'Authorization': f'Bearer {self.token}',
            'Content-Type': 'application/json'
        }

        self.client.post('/api/chat',
            headers=headers,
            json={
                'message': 'å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆã«ã¤ã„ã¦æ•™ãˆã¦',
                'model': 'claude-3-5-sonnet'
            },
            name='/api/chat'
        )

    @task(3)
    def get_search_history(self):
        """æ¤œç´¢å±¥æ­´å–å¾—"""
        headers = {'Authorization': f'Bearer {self.token}'}

        self.client.get('/api/history',
            headers=headers,
            name='/api/history'
        )

    @task(1)
    def get_presigned_url(self):
        """ç½²åä»˜ãURLå–å¾—"""
        headers = {
            'Authorization': f'Bearer {self.token}',
            'Content-Type': 'application/json'
        }

        self.client.post('/api/documents/presigned-url',
            headers=headers,
            json={
                'documentKey': 'SG-Sales/report-2024Q3.pdf'
            },
            name='/api/documents/presigned-url'
        )

# å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
# locust -f locustfile.py --host=https://api-dev2.isuzu.co.jp --users=1000 --spawn-rate=50
```

---

## ğŸ¤– ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–æˆ¦ç•¥

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CI/CD Pipeline with Automated Testing            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  [git push]                                                    â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ GitHub      â”‚ â‘  ã‚³ãƒŸãƒƒãƒˆæ™‚                                 â”‚
â”‚  â”‚ Actions     â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ å˜ä½“ãƒ†ã‚¹ãƒˆ  â”‚ pytest / Jest                                â”‚
â”‚  â”‚ (200ä»¶)     â”‚ ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸: 80%ä»¥ä¸Š                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ çµ±åˆãƒ†ã‚¹ãƒˆ  â”‚ pytest + moto / Jest + AWS SDK Mock          â”‚
â”‚  â”‚ (50ä»¶)      â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ CDK Synth   â”‚ CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ CDK Deploy  â”‚ â‘¡ ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆdevç’°å¢ƒï¼‰                        â”‚
â”‚  â”‚ (dev)       â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ E2Eãƒ†ã‚¹ãƒˆ   â”‚ CloudWatch Synthetics (Canary)               â”‚
â”‚  â”‚ (10ä»¶)      â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£â”‚ AWS Security Hub + Inspector                 â”‚
â”‚  â”‚ ã‚¹ã‚­ãƒ£ãƒ³    â”‚ è‡ªå‹•å®Ÿè¡Œï¼ˆ5åˆ†å¾Œï¼‰                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚       â”‚                                                        â”‚
â”‚       â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚  â”‚ è² è·ãƒ†ã‚¹ãƒˆ  â”‚ Locust (é€±æ¬¡ or ãƒªãƒªãƒ¼ã‚¹å‰)                  â”‚
â”‚  â”‚ (æ‰‹å‹•å®Ÿè¡Œ)  â”‚                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹

```yaml
# .github/workflows/test-and-deploy.yml
name: Test and Deploy

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  unit-test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.11]
        node-version: [18.x]

    steps:
      - uses: actions/checkout@v3

      # Pythonå˜ä½“ãƒ†ã‚¹ãƒˆ
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python-version }}

      - name: Install Python dependencies
        run: |
          pip install -r requirements-dev.txt

      - name: Run Python unit tests
        run: |
          pytest tests/unit/ --cov=app --cov-report=xml --cov-report=term

      - name: Check coverage
        run: |
          coverage report --fail-under=80

      # TypeScriptå˜ä½“ãƒ†ã‚¹ãƒˆ
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}

      - name: Install Node dependencies
        run: |
          npm ci

      - name: Run TypeScript unit tests
        run: |
          npm test -- --coverage --coverageThreshold='{"global":{"lines":80}}'

  integration-test:
    needs: unit-test
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.11

      - name: Install dependencies
        run: |
          pip install -r requirements-dev.txt

      - name: Run integration tests
        run: |
          pytest tests/integration/ -v

  cdk-synth:
    needs: integration-test
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18.x

      - name: Install dependencies
        run: |
          npm ci

      - name: CDK Synth
        run: |
          npm run cdk:synth

      - name: Upload CloudFormation template
        uses: actions/upload-artifact@v3
        with:
          name: cdk-templates
          path: cdk.out/

  deploy-dev:
    needs: cdk-synth
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'
    environment: dev

    steps:
      - uses: actions/checkout@v3

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ap-northeast-1

      - name: CDK Deploy (dev)
        run: |
          npm run cdk:deploy -- --require-approval never

  e2e-test:
    needs: deploy-dev
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'

    steps:
      - uses: actions/checkout@v3

      - name: Wait for deployment to stabilize
        run: sleep 60

      - name: Trigger CloudWatch Synthetics Canary
        run: |
          aws synthetics start-canary --name genu-chat-ui-e2e

      - name: Wait for Canary execution
        run: sleep 300

      - name: Check Canary results
        run: |
          RESULT=$(aws synthetics get-canary-runs \
            --name genu-chat-ui-e2e \
            --max-results 1 \
            --query 'CanaryRuns[0].Status.State' \
            --output text)

          if [ "$RESULT" != "PASSED" ]; then
            echo "E2E test failed: $RESULT"
            exit 1
          fi

  security-scan:
    needs: deploy-dev
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'

    steps:
      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ap-northeast-1

      - name: Wait for Security Hub scan
        run: sleep 300

      - name: Check Security Hub findings
        run: |
          CRITICAL_FINDINGS=$(aws securityhub get-findings \
            --filters '{"SeverityLabel":[{"Value":"CRITICAL","Comparison":"EQUALS"}],"RecordState":[{"Value":"ACTIVE","Comparison":"EQUALS"}]}' \
            --query 'length(Findings)' \
            --output text)

          if [ $CRITICAL_FINDINGS -gt 0 ]; then
            echo "Critical security findings detected: $CRITICAL_FINDINGS"
            exit 1
          fi
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### ç’°å¢ƒæ§‹æˆ

| ç’°å¢ƒ | ç”¨é€” | ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ãƒ†ã‚¹ãƒˆå†…å®¹ |
|------|------|------------------|----------|
| **dev** | é–‹ç™ºãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ | ã‚³ãƒŸãƒƒãƒˆæ™‚ï¼ˆè‡ªå‹•ï¼‰ | å˜ä½“ãƒ»çµ±åˆãƒ»E2Eãƒ†ã‚¹ãƒˆ |
| **staging** | æœ¬ç•ªå‰æ¤œè¨¼ | ãƒªãƒªãƒ¼ã‚¹å‰ï¼ˆæ‰‹å‹•æ‰¿èªï¼‰ | è² è·ãƒ†ã‚¹ãƒˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã€å—å…¥ãƒ†ã‚¹ãƒˆ |
| **prod** | æœ¬ç•ªç’°å¢ƒ | ãƒªãƒªãƒ¼ã‚¹æ™‚ï¼ˆæ‰‹å‹•æ‰¿èªï¼‰ | ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã€ç›£è¦– |

### ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†

```typescript
// CDK: ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿è‡ªå‹•æŠ•å…¥
import * as customResources from 'aws-cdk-lib/custom-resources';

const seedTestData = new customResources.AwsCustomResource(this, 'SeedTestData', {
  onCreate: {
    service: 'S3',
    action: 'putObject',
    parameters: {
      Bucket: documentBucket.bucketName,
      Key: 'SG-TestDepartment/test-document.pdf',
      Body: 'Test content',
    },
    physicalResourceId: customResources.PhysicalResourceId.of('seed-test-data'),
  },
  policy: customResources.AwsCustomResourcePolicy.fromSdkCalls({
    resources: [documentBucket.bucketArn + '/*'],
  }),
});

// ãƒ†ã‚¹ãƒˆç”¨Cognitoãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
const createTestUser = new customResources.AwsCustomResource(this, 'CreateTestUser', {
  onCreate: {
    service: 'CognitoIdentityServiceProvider',
    action: 'adminCreateUser',
    parameters: {
      UserPoolId: userPool.userPoolId,
      Username: 'testuser@example.com',
      TemporaryPassword: 'TempPassword123!',
      UserAttributes: [
        { Name: 'email', Value: 'testuser@example.com' },
        { Name: 'email_verified', Value: 'true' },
      ],
    },
    physicalResourceId: customResources.PhysicalResourceId.of('test-user'),
  },
  policy: customResources.AwsCustomResourcePolicy.fromSdkCalls({
    resources: [userPool.userPoolArn],
  }),
});
```

---

## ğŸ“ˆ ãƒ†ã‚¹ãƒˆå·¥æ•°ãƒ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### ãƒ†ã‚¹ãƒˆå·¥æ•°è¦‹ç©

| ãƒ†ã‚¹ãƒˆã‚«ãƒ†ã‚´ãƒª | å·¥æ•°è¦‹ç© | å†…è¨³ |
|--------------|---------|------|
| **ãƒ†ã‚¹ãƒˆè¨­è¨ˆ** | 8äººæ—¥ | - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨­è¨ˆ: 5äººæ—¥<br>- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™: 3äººæ—¥ |
| **å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…** | 15äººæ—¥ | - Lambdaé–¢æ•°ãƒ†ã‚¹ãƒˆ: 10äººæ—¥<br>- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ: 5äººæ—¥ |
| **çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…** | 10äººæ—¥ | - APIçµ±åˆãƒ†ã‚¹ãƒˆ: 7äººæ—¥<br>- AWSã‚µãƒ¼ãƒ“ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ: 3äººæ—¥ |
| **E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…** | 5äººæ—¥ | - CloudWatch Syntheticsè¨­å®š: 3äººæ—¥<br>- Canaryã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè£…: 2äººæ—¥ |
| **è² è·ãƒ†ã‚¹ãƒˆ** | 3äººæ—¥ | - Locustã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè£…: 2äººæ—¥<br>- è² è·ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»åˆ†æ: 1äººæ—¥ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆè¨­å®š** | 3äººæ—¥ | - Security Hubè¨­å®š: 1äººæ—¥<br>- Inspectorè¨­å®š: 1äººæ—¥<br>- Config Rulesè¨­å®š: 1äººæ—¥ |
| **CI/CDçµ±åˆ** | 5äººæ—¥ | - GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: 3äººæ—¥<br>- ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³: 2äººæ—¥ |
| **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»ãƒã‚°ä¿®æ­£** | 10äººæ—¥ | - åˆå›ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: 3äººæ—¥<br>- ãƒã‚°ä¿®æ­£ãƒ»å†ãƒ†ã‚¹ãƒˆ: 7äººæ—¥ |

**ãƒ†ã‚¹ãƒˆå·¥æ•° åˆè¨ˆ**: **ç´„59äººæ—¥**

### ãƒ†ã‚¹ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

```
Week 1-2: ãƒ†ã‚¹ãƒˆè¨­è¨ˆãƒ»ç’°å¢ƒæº–å‚™
â”œâ”€ ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨­è¨ˆ
â”œâ”€ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™
â””â”€ CI/CDç’°å¢ƒæ§‹ç¯‰

Week 3-5: ãƒ†ã‚¹ãƒˆå®Ÿè£…
â”œâ”€ å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆLambda/ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
â”œâ”€ çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…
â”œâ”€ E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆSyntheticsï¼‰
â””â”€ è² è·ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

Week 6-7: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ»ä¿®æ­£
â”œâ”€ åˆå›ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
â”œâ”€ ãƒã‚°ä¿®æ­£
â”œâ”€ å†ãƒ†ã‚¹ãƒˆ
â””â”€ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ

Week 8: æœ€çµ‚æ¤œè¨¼
â”œâ”€ è² è·ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
â”œâ”€ å—å…¥ãƒ†ã‚¹ãƒˆ
â””â”€ æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™
```

---

## ğŸ“‹ ãƒ†ã‚¹ãƒˆå®Œäº†åŸºæº–

### å“è³ªã‚²ãƒ¼ãƒˆ

| å“è³ªæŒ‡æ¨™ | åŸºæº–å€¤ | æ¸¬å®šæ–¹æ³• |
|---------|--------|---------|
| **å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸** | 80%ä»¥ä¸Š | pytest-cov / Jest coverage |
| **çµ±åˆãƒ†ã‚¹ãƒˆæˆåŠŸç‡** | 100% | CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ |
| **E2Eãƒ†ã‚¹ãƒˆæˆåŠŸç‡** | 100% | CloudWatch Synthetics |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³** | Critical: 0ä»¶<br>High: 5ä»¶ä»¥ä¸‹ | Security Hub / Inspector |
| **è² è·ãƒ†ã‚¹ãƒˆ** | 95ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«: 3ç§’ä»¥å†…<br>ã‚¨ãƒ©ãƒ¼ç‡: 0.1%ä»¥ä¸‹ | Locust / CloudWatch |
| **Config Rulesæº–æ‹ ** | 100% | AWS Config |

### ãƒªãƒªãƒ¼ã‚¹åˆ¤å®šåŸºæº–

ä»¥ä¸‹ã®ã™ã¹ã¦ã®æ¡ä»¶ã‚’æº€ãŸã—ãŸå ´åˆã€æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å¯èƒ½ã¨åˆ¤å®šã—ã¾ã™:

1. âœ… ã™ã¹ã¦ã®å˜ä½“ãƒ†ã‚¹ãƒˆãŒæˆåŠŸï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šï¼‰
2. âœ… ã™ã¹ã¦ã®çµ±åˆãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
3. âœ… E2Eãƒ†ã‚¹ãƒˆãŒ3å›é€£ç¶šã§æˆåŠŸ
4. âœ… Security Hub ã® Critical æ¤œå‡ºæ•°ãŒ 0ä»¶
5. âœ… Inspector ã®è„†å¼±æ€§ï¼ˆCritical/Highï¼‰ãŒ 0ä»¶
6. âœ… Config Rules ã®éæº–æ‹ ãŒ 0ä»¶
7. âœ… è² è·ãƒ†ã‚¹ãƒˆã§ç›®æ¨™ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’é”æˆ
8. âœ… ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã«ã‚ˆã‚‹å—å…¥ãƒ†ã‚¹ãƒˆãŒå®Œäº†

---

**ä½œæˆè€…**: SIé–‹ç™ºãƒãƒ¼ãƒ  | **æœ€çµ‚æ›´æ–°**: 2025-12-12 | **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
